{"pageProps":{"note":{"id":"wi6q59zkivy4h3n4aq88r0o","title":"Spark Profiler","desc":"","updated":1709273702798,"created":1682131570817,"custom":{},"fname":"ljc.profiler","type":"note","vault":{"fsPath":".","selfContained":true,"name":"info"},"contentHash":"12b2a4a35d0424255a9be4eca7b3552f","links":[{"from":{"id":"11v7y4rd2yew42mm3atk766","fname":"ljc","vaultName":"info"},"type":"backlink","position":{"start":{"line":11,"column":4,"offset":298},"end":{"line":11,"column":35,"offset":329},"indent":[]},"value":"ljc.profiler","alias":"Diagnosing Lag"},{"from":{"id":"58j9dmu743w7r68zdh3ws7r","fname":"ljc.install","vaultName":"info"},"type":"backlink","position":{"start":{"line":36,"column":84,"offset":1505},"end":{"line":36,"column":100,"offset":1521},"indent":[]},"value":"ljc.profiler"}],"anchors":{"finding-lag":{"type":"header","text":"Finding Lag","value":"finding-lag","line":11,"column":0,"depth":2},"1-monitoring-ticks":{"type":"header","text":"1. Monitoring Ticks","value":"1-monitoring-ticks","line":14,"column":0,"depth":3},"2-profiling-the-game":{"type":"header","text":"2. Profiling the Game","value":"2-profiling-the-game","line":27,"column":0,"depth":3}},"children":[],"parent":"11v7y4rd2yew42mm3atk766","data":{}},"body":"<h1 id=\"spark-profiler\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#spark-profiler\"></a>Spark Profiler</h1>\n<p>If you're experiencing lag in this modpack, this is a guide on how to pinpoint the lag (or at the very least help me help you.)</p>\n<p>If it isn't already. Close your game and install <a href=\"https://spark.lucko.me\">Spark</a>. You can test to see if it's installed by running <code>/sparkc</code> in-game, if it returns command not found, you need to install it.</p>\n<h2 id=\"finding-lag\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#finding-lag\"></a>Finding Lag</h2>\n<p>After installing Spark we need to determine a few things. Firstly, how long our lag spikes last, and then we can profile our game to actually find the source of the problem.</p>\n<h3 id=\"1-monitoring-ticks\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#1-monitoring-ticks\"></a>1. Monitoring Ticks</h3>\n<p>First up we need to start our Tick monitor. Achieve this by running <code>/sparkc tickmonitor</code></p>\n<p><img src=\"/./assets/images/2023-04-21-23-29-28.png\"></p>\n<p><img src=\"/./assets/images/2023-04-21-23-30-30.png\">\nAfter the Initial analysis completes you may find some issues about GC, you can ignore this for now. Java's Garbage collector is... Garbage... We are looking for a HUGE spike in ticks.</p>\n<p><img src=\"/./assets/images/2023-04-21-23-33-13.png\">\nThis is a pretty Sizeable spike! so much so it kicked me from the server! (hence the dimmed screenshot)</p>\n<p>Now we can run our profiler to try and find the actual source of the lag!</p>\n<h3 id=\"2-profiling-the-game\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#2-profiling-the-game\"></a>2. Profiling the Game</h3>\n<p>Now that we have some numbers we'll try and only capture the major spikes! First we need to take the lowest large spike, round it down to the nearest 50 and then start profiling it!</p>\n<p>In the case above, our lowest significant spike was 106.76ms, so we'll round it down to 100</p>\n<p><img src=\"/./assets/images/2023-04-21-23-38-24.png\">\n<img src=\"/./assets/images/2023-04-21-23-38-51.png\"></p>\n<p>Now our profiler is running, When any spike happens over 100ms it will be captured in our profiler! We want to try and recreate the lag as best we can (while avoiding a crash!).</p>\n<p>After we re-produce our spike, we can run <code>/sparkc profiler stop</code>\n<img src=\"/./assets/images/2023-04-21-23-42-05.png\"></p>\n<p>And our report will be generated!\n<img src=\"/./assets/images/2023-04-21-23-42-25.png\"></p>\n<p>While we're at it let's also disable the tickmonitor\n<img src=\"/./assets/images/2023-04-21-23-43-14.png\"></p>\n<p>Now we just click the link, and either open in browser to view it or copy to clipboard to throw at Java.\n<img src=\"/./assets/images/2023-04-21-23-44-11.png\"></p>\n<p>Examining the Profiler report is out of scope for this guide! You can instead follow the documentation from the <a href=\"https://spark.lucko.me/docs/Using-the-viewer\">Spark page!</a></p>\n<p>This guide was mostly derived from the Spark documentation anyway. Just in a more verbose manner.</p>\n<hr>\n<strong>Backlinks</strong>\n<ul>\n<li><a href=\"/notes/11v7y4rd2yew42mm3atk766\">LividJava's Create</a></li>\n<li><a href=\"/notes/58j9dmu743w7r68zdh3ws7r\">Installing the Modpack</a></li>\n</ul>","noteIndex":{"id":"rz6ooe5c8yfobnumbkp5b7o","title":"Java's Database","desc":"","updated":1751092151911,"created":1682130791054,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":".","selfContained":true,"name":"info"},"contentHash":"c42c170ad293c55a0d8748b9e1866295","links":[],"anchors":{"welcome-to-javas-info-database":{"type":"header","text":"Welcome to Java's Info Database!","value":"welcome-to-javas-info-database","line":7,"column":0,"depth":1}},"children":["8x3wnpiw1n98nzo4b6rqgfm","11v7y4rd2yew42mm3atk766","vybdzd0m847pavn5b3acc5g","4gd2597fi4hc5ftx3t4w0o4","o3qg0g31qwt9zdc1anfhn9v","zz475xfe9354uf3cvgu5yew"],"parent":null,"data":{},"body":"# Welcome to Java's Info Database!\nHere is a collection of information Java uses for various things! if you were Linked here, chances are it was for a tutorial of some kind!\n\nIf you've come from the far reaches of the internet, welcome! You'll find a variety of little things from personal mumblings to tutorials made for friends. Maybe you too will find something useful!"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":".","selfContained":true,"name":"info"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableMermaid":true},"publishing":{"theme":"dark","enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","siteUrl":"https://infodb.lividjava.xyz","seo":{"title":"Java's Database","description":"A collection of information created by a ü¶ù with a üîß"},"github":{"enableEditLink":false,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","enableMermaid":true,"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}
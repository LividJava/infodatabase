<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><title>Spark Profiler</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="A collection of information created by a 🦝 with a 🔧"/><meta property="og:title" content="Spark Profiler"/><meta property="og:description" content="A collection of information created by a 🦝 with a 🔧"/><meta property="og:url" content="https://infodb.lividjava.xyz/notes/wi6q59zkivy4h3n4aq88r0o/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="4/22/2023"/><meta property="article:modified_time" content="3/1/2024"/><link rel="canonical" href="https://infodb.lividjava.xyz/notes/wi6q59zkivy4h3n4aq88r0o/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/8e7b7e4bce421c0a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8e7b7e4bce421c0a.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-3d209faeb64f2f97.js" defer=""></script><script src="/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/_next/static/chunks/main-104451f3d1a5c4bc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9d8e0603730b15a3.js" defer=""></script><script src="/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/_next/static/c4YRaVxigXrsRZTo9FpXp/_buildManifest.js" defer=""></script><script src="/_next/static/c4YRaVxigXrsRZTo9FpXp/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="spark-profiler"><a aria-hidden="true" class="anchor-heading icon-link" href="#spark-profiler"></a>Spark Profiler</h1>
<p>If you're experiencing lag in this modpack, this is a guide on how to pinpoint the lag (or at the very least help me help you.)</p>
<p>If it isn't already. Close your game and install <a href="https://spark.lucko.me">Spark</a>. You can test to see if it's installed by running <code>/sparkc</code> in-game, if it returns command not found, you need to install it.</p>
<h2 id="finding-lag"><a aria-hidden="true" class="anchor-heading icon-link" href="#finding-lag"></a>Finding Lag</h2>
<p>After installing Spark we need to determine a few things. Firstly, how long our lag spikes last, and then we can profile our game to actually find the source of the problem.</p>
<h3 id="1-monitoring-ticks"><a aria-hidden="true" class="anchor-heading icon-link" href="#1-monitoring-ticks"></a>1. Monitoring Ticks</h3>
<p>First up we need to start our Tick monitor. Achieve this by running <code>/sparkc tickmonitor</code></p>
<p><img src="/./assets/images/2023-04-21-23-29-28.png"></p>
<p><img src="/./assets/images/2023-04-21-23-30-30.png">
After the Initial analysis completes you may find some issues about GC, you can ignore this for now. Java's Garbage collector is... Garbage... We are looking for a HUGE spike in ticks.</p>
<p><img src="/./assets/images/2023-04-21-23-33-13.png">
This is a pretty Sizeable spike! so much so it kicked me from the server! (hence the dimmed screenshot)</p>
<p>Now we can run our profiler to try and find the actual source of the lag!</p>
<h3 id="2-profiling-the-game"><a aria-hidden="true" class="anchor-heading icon-link" href="#2-profiling-the-game"></a>2. Profiling the Game</h3>
<p>Now that we have some numbers we'll try and only capture the major spikes! First we need to take the lowest large spike, round it down to the nearest 50 and then start profiling it!</p>
<p>In the case above, our lowest significant spike was 106.76ms, so we'll round it down to 100</p>
<p><img src="/./assets/images/2023-04-21-23-38-24.png">
<img src="/./assets/images/2023-04-21-23-38-51.png"></p>
<p>Now our profiler is running, When any spike happens over 100ms it will be captured in our profiler! We want to try and recreate the lag as best we can (while avoiding a crash!).</p>
<p>After we re-produce our spike, we can run <code>/sparkc profiler stop</code>
<img src="/./assets/images/2023-04-21-23-42-05.png"></p>
<p>And our report will be generated!
<img src="/./assets/images/2023-04-21-23-42-25.png"></p>
<p>While we're at it let's also disable the tickmonitor
<img src="/./assets/images/2023-04-21-23-43-14.png"></p>
<p>Now we just click the link, and either open in browser to view it or copy to clipboard to throw at Java.
<img src="/./assets/images/2023-04-21-23-44-11.png"></p>
<p>Examining the Profiler report is out of scope for this guide! You can instead follow the documentation from the <a href="https://spark.lucko.me/docs/Using-the-viewer">Spark page!</a></p>
<p>This guide was mostly derived from the Spark documentation anyway. Just in a more verbose manner.</p>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/notes/11v7y4rd2yew42mm3atk766">LividJava's Create</a></li>
<li><a href="/notes/58j9dmu743w7r68zdh3ws7r">Installing the Modpack</a></li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#finding-lag" title="Finding Lag">Finding Lag</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#1-monitoring-ticks" title="1. Monitoring Ticks">1. Monitoring Ticks</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#2-profiling-the-game" title="2. Profiling the Game">2. Profiling the Game</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"wi6q59zkivy4h3n4aq88r0o","title":"Spark Profiler","desc":"","updated":1709273702798,"created":1682131570817,"custom":{},"fname":"ljc.profiler","type":"note","vault":{"fsPath":".","selfContained":true,"name":"info"},"contentHash":"12b2a4a35d0424255a9be4eca7b3552f","links":[{"from":{"id":"11v7y4rd2yew42mm3atk766","fname":"ljc","vaultName":"info"},"type":"backlink","position":{"start":{"line":11,"column":4,"offset":298},"end":{"line":11,"column":35,"offset":329},"indent":[]},"value":"ljc.profiler","alias":"Diagnosing Lag"},{"from":{"id":"58j9dmu743w7r68zdh3ws7r","fname":"ljc.install","vaultName":"info"},"type":"backlink","position":{"start":{"line":36,"column":84,"offset":1505},"end":{"line":36,"column":100,"offset":1521},"indent":[]},"value":"ljc.profiler"}],"anchors":{"finding-lag":{"type":"header","text":"Finding Lag","value":"finding-lag","line":11,"column":0,"depth":2},"1-monitoring-ticks":{"type":"header","text":"1. Monitoring Ticks","value":"1-monitoring-ticks","line":14,"column":0,"depth":3},"2-profiling-the-game":{"type":"header","text":"2. Profiling the Game","value":"2-profiling-the-game","line":27,"column":0,"depth":3}},"children":[],"parent":"11v7y4rd2yew42mm3atk766","data":{}},"body":"\u003ch1 id=\"spark-profiler\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#spark-profiler\"\u003e\u003c/a\u003eSpark Profiler\u003c/h1\u003e\n\u003cp\u003eIf you're experiencing lag in this modpack, this is a guide on how to pinpoint the lag (or at the very least help me help you.)\u003c/p\u003e\n\u003cp\u003eIf it isn't already. Close your game and install \u003ca href=\"https://spark.lucko.me\"\u003eSpark\u003c/a\u003e. You can test to see if it's installed by running \u003ccode\u003e/sparkc\u003c/code\u003e in-game, if it returns command not found, you need to install it.\u003c/p\u003e\n\u003ch2 id=\"finding-lag\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#finding-lag\"\u003e\u003c/a\u003eFinding Lag\u003c/h2\u003e\n\u003cp\u003eAfter installing Spark we need to determine a few things. Firstly, how long our lag spikes last, and then we can profile our game to actually find the source of the problem.\u003c/p\u003e\n\u003ch3 id=\"1-monitoring-ticks\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#1-monitoring-ticks\"\u003e\u003c/a\u003e1. Monitoring Ticks\u003c/h3\u003e\n\u003cp\u003eFirst up we need to start our Tick monitor. Achieve this by running \u003ccode\u003e/sparkc tickmonitor\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/./assets/images/2023-04-21-23-29-28.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/./assets/images/2023-04-21-23-30-30.png\"\u003e\nAfter the Initial analysis completes you may find some issues about GC, you can ignore this for now. Java's Garbage collector is... Garbage... We are looking for a HUGE spike in ticks.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/./assets/images/2023-04-21-23-33-13.png\"\u003e\nThis is a pretty Sizeable spike! so much so it kicked me from the server! (hence the dimmed screenshot)\u003c/p\u003e\n\u003cp\u003eNow we can run our profiler to try and find the actual source of the lag!\u003c/p\u003e\n\u003ch3 id=\"2-profiling-the-game\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#2-profiling-the-game\"\u003e\u003c/a\u003e2. Profiling the Game\u003c/h3\u003e\n\u003cp\u003eNow that we have some numbers we'll try and only capture the major spikes! First we need to take the lowest large spike, round it down to the nearest 50 and then start profiling it!\u003c/p\u003e\n\u003cp\u003eIn the case above, our lowest significant spike was 106.76ms, so we'll round it down to 100\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/./assets/images/2023-04-21-23-38-24.png\"\u003e\n\u003cimg src=\"/./assets/images/2023-04-21-23-38-51.png\"\u003e\u003c/p\u003e\n\u003cp\u003eNow our profiler is running, When any spike happens over 100ms it will be captured in our profiler! We want to try and recreate the lag as best we can (while avoiding a crash!).\u003c/p\u003e\n\u003cp\u003eAfter we re-produce our spike, we can run \u003ccode\u003e/sparkc profiler stop\u003c/code\u003e\n\u003cimg src=\"/./assets/images/2023-04-21-23-42-05.png\"\u003e\u003c/p\u003e\n\u003cp\u003eAnd our report will be generated!\n\u003cimg src=\"/./assets/images/2023-04-21-23-42-25.png\"\u003e\u003c/p\u003e\n\u003cp\u003eWhile we're at it let's also disable the tickmonitor\n\u003cimg src=\"/./assets/images/2023-04-21-23-43-14.png\"\u003e\u003c/p\u003e\n\u003cp\u003eNow we just click the link, and either open in browser to view it or copy to clipboard to throw at Java.\n\u003cimg src=\"/./assets/images/2023-04-21-23-44-11.png\"\u003e\u003c/p\u003e\n\u003cp\u003eExamining the Profiler report is out of scope for this guide! You can instead follow the documentation from the \u003ca href=\"https://spark.lucko.me/docs/Using-the-viewer\"\u003eSpark page!\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThis guide was mostly derived from the Spark documentation anyway. Just in a more verbose manner.\u003c/p\u003e\n\u003chr\u003e\n\u003cstrong\u003eBacklinks\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/11v7y4rd2yew42mm3atk766\"\u003eLividJava's Create\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/58j9dmu743w7r68zdh3ws7r\"\u003eInstalling the Modpack\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"rz6ooe5c8yfobnumbkp5b7o","title":"Java's Database","desc":"","updated":1751092151911,"created":1682130791054,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":".","selfContained":true,"name":"info"},"contentHash":"c42c170ad293c55a0d8748b9e1866295","links":[],"anchors":{"welcome-to-javas-info-database":{"type":"header","text":"Welcome to Java's Info Database!","value":"welcome-to-javas-info-database","line":7,"column":0,"depth":1}},"children":["8x3wnpiw1n98nzo4b6rqgfm","11v7y4rd2yew42mm3atk766","vybdzd0m847pavn5b3acc5g","4gd2597fi4hc5ftx3t4w0o4","o3qg0g31qwt9zdc1anfhn9v","zz475xfe9354uf3cvgu5yew"],"parent":null,"data":{},"body":"# Welcome to Java's Info Database!\nHere is a collection of information Java uses for various things! if you were Linked here, chances are it was for a tutorial of some kind!\n\nIf you've come from the far reaches of the internet, welcome! You'll find a variety of little things from personal mumblings to tutorials made for friends. Maybe you too will find something useful!"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":".","selfContained":true,"name":"info"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableMermaid":true},"publishing":{"theme":"dark","enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","siteUrl":"https://infodb.lividjava.xyz","seo":{"title":"Java's Database","description":"A collection of information created by a 🦝 with a 🔧"},"github":{"enableEditLink":false,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","enableMermaid":true,"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"wi6q59zkivy4h3n4aq88r0o"},"buildId":"c4YRaVxigXrsRZTo9FpXp","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>